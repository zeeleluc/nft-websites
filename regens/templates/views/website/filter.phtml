<div class="container-fluid mt-4">
    <div class="row justify-content-center">
        <div class="col col-12">
            <h1><a href="<?=env('APP_ORIGIN_URL'); ?>">RE:FILTER</a></h1>
        </div>
    </div>
</div>


<div class="container-fluid mb-2 px-5">
    <div class="row justify-content-center text-center">

        <p class="px-2 mt-5">
            <?= strtoupper($totalFilteredNFTs); ?> RE:GEN<?= $totalFilteredNFTs > 1 ? 'S' : ''; ?> FOUND
        </p>

        <p>
            <?php foreach (\App\Service\Filter::parse($currentFilter) as $trait => $property): ?>
                <a class="btn" href="<?=env('APP_ORIGIN_URL'); ?>/filter/<?=undo_spaces(\App\Service\Filter::queryRemoveTrait($currentFilter, $trait)); ?>">
                    <?=$property; ?>
                </a>
            <?php endforeach; ?>
        </p>
    </div>


    <div class="pagination">

        <?php if ($totalPages > 5): ?>

            <!-- First Page -->
            <?php if ($currentPage > 1): ?>
                <a href="?page=1">&lt;&lt;</a>
            <?php endif; ?>

            <!-- Previous Page -->
            <?php if ($currentPage > 1): ?>
                <a href="?page=<?= $currentPage - 1 ?>">&lt;</a>
            <?php endif; ?>

        <?php endif; ?>

        <!-- Page numbers -->
        <?php
        $start = max(1, $currentPage - 2);
        $end = min($totalPages, $currentPage + 2);
        ?>

        <!-- Show "1 ..." if current page is far from the start -->
        <?php if ($start > 1): ?>
            <a href="?page=1">1</a>
            <?php if ($start > 2): ?>
                <span>...</span>
            <?php endif; ?>
        <?php endif; ?>

        <!-- Main Page Links -->
        <?php for ($i = $start; $i <= $end; $i++): ?>
            <?php if ($i == $currentPage): ?>
                <span class="current"><?= $i ?></span>
            <?php else: ?>
                <a href="?page=<?= $i ?>"><?= $i ?></a>
            <?php endif; ?>
        <?php endfor; ?>

        <!-- Show "... last page" if current page is far from the end -->
        <?php if ($end < $totalPages): ?>
            <?php if ($end < $totalPages - 1): ?>
                <span>...</span>
            <?php endif; ?>
            <a href="?page=<?= $totalPages ?>"><?= $totalPages ?></a>
        <?php endif; ?>

        <?php if ($totalPages > 5): ?>
            <!-- Next Page -->
            <?php if ($currentPage < $totalPages): ?>
                <a href="?page=<?= $currentPage + 1 ?>">&gt;</a>
            <?php endif; ?>

            <!-- Last Page -->
            <?php if ($currentPage < $totalPages): ?>
                <a href="?page=<?= $totalPages ?>">&gt;&gt;</a>
            <?php endif; ?>
        <?php endif; ?>
    </div>



    <div class="row justify-content-center">
        <?php foreach ($filteredNFTs as $NFT): ?>
            <div class="col col-12 col-sm-6 col-md-4 col-lg-3 col-xl-3 col-xxl-3 mt-4">
                <?php require ROOT . "/templates/views/website/partials/nft-card.phtml"; ?>
            </div>
        <?php endforeach; ?>
    </div>



    <div class="pagination">

        <?php if ($totalPages > 5): ?>

            <!-- First Page -->
            <?php if ($currentPage > 1): ?>
                <a href="?page=1">&lt;&lt;</a>
            <?php endif; ?>

            <!-- Previous Page -->
            <?php if ($currentPage > 1): ?>
                <a href="?page=<?= $currentPage - 1 ?>">&lt;</a>
            <?php endif; ?>

        <?php endif; ?>

        <!-- Page numbers -->
        <?php
        $start = max(1, $currentPage - 2);
        $end = min($totalPages, $currentPage + 2);
        ?>

        <!-- Show "1 ..." if current page is far from the start -->
        <?php if ($start > 1): ?>
            <a href="?page=1">1</a>
            <?php if ($start > 2): ?>
                <span>...</span>
            <?php endif; ?>
        <?php endif; ?>

        <!-- Main Page Links -->
        <?php for ($i = $start; $i <= $end; $i++): ?>
            <?php if ($i == $currentPage): ?>
                <span class="current"><?= $i ?></span>
            <?php else: ?>
                <a href="?page=<?= $i ?>"><?= $i ?></a>
            <?php endif; ?>
        <?php endfor; ?>

        <!-- Show "... last page" if current page is far from the end -->
        <?php if ($end < $totalPages): ?>
            <?php if ($end < $totalPages - 1): ?>
                <span>...</span>
            <?php endif; ?>
            <a href="?page=<?= $totalPages ?>"><?= $totalPages ?></a>
        <?php endif; ?>

        <?php if ($totalPages > 5): ?>
            <!-- Next Page -->
            <?php if ($currentPage < $totalPages): ?>
                <a href="?page=<?= $currentPage + 1 ?>">&gt;</a>
            <?php endif; ?>

            <!-- Last Page -->
            <?php if ($currentPage < $totalPages): ?>
                <a href="?page=<?= $totalPages ?>">&gt;&gt;</a>
            <?php endif; ?>
        <?php endif; ?>
    </div>

</div>
